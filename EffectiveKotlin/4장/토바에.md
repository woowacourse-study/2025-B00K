# 아이템 4 - inferred 타입으로 리턴하지 말라

### 코틀린의 타입 추론 (type inference)

- 코틀린의 특징 중 하나
- 제한이 너무 많아지거나 예측하지 못한 결과를 만들 수 있음

### 타입 추론을 할 때 위험한 부분

- 할당 할 때 inferred 타입은 오른쪽에 있는 피연산자에 맞게 설정
- 슈퍼클래스 또는 인터페이스로는 설정되지 않음

```kotlin
open class Animal
class Zebra: Animal()

fun main() {
	var animal = Zebar()
	animal = Animal() // 오류: Type mismatch
}
```

→ 타입을 명시적으로 지정해서 문제 해결

```kotlin
open class Animal
class Zebra: Animal()

fun main() {
	var animal: Animal = Zebar()
	animal = Animal()
}
```

- 직접 라이브러리 또는 모듈을 조작할 수 없는 경우에는 불가능
- 직접 라이브러리 또는 모듈을 조작할 수 없는 경우에는 inferred 타입을 노출하면 문제 발생

```kotlin
interface CarFactory {
	fun produce(): Car
}

val DEFAULT_CAR: Car = Fiat126P() // 대부분의 공장에서 생성해서 디폴트 값 설정
```

DEFAULT_CAR는 Car로 명시적으로 지정되어 있으므로 리턴 타입 제거

```kotlin
interface CarFactory {
	fun produce() = DEFAULT_CAR
}

// 누군가 DEFAULT_CAR의 Car 명시 제거
val DEFAULT_CAR = Fiat126P()
```

→ 모든 CarFactory는 Fiat126P()만 생산 가능, 만약 외부 API라면 문제를 쉽게 해결하지 못함

### 리턴 타입

- API를 잘 모르는 사람에게 전달해 줄 수 있는 중요한 정보
- 외부에서 확인할 수 있게 명시적으로 지정
- 안전을 위해 외부 API를 만들 때 반드시 타입 지정
- 지정한 타입을 특별한 이유와 확실한 확인 없이 제거하지 말자
