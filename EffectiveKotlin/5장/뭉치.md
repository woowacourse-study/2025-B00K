# 5. 예외를 활용해 코드에 제한을 걸어라'

- `require` : 아규먼트를 제한할 수 있다.
- `check` : 상태와 관련된 동작을 제한할 수 있다.
- `assert` : 어떤 것이 true 인지 확인할 수 있다. (테스트에서만 작동)
- `return / throw와 함께 활용하는 Elvis`
- 장점:
    - 문서를 읽지 않은 개발자도 문제를 확인할 수 있다.
    - 문제가 있어 예상치 못한 동작을 하는 것보다 예외를 throw 하는 것이 낫다.
    - 코드가 자체적으로 검사되어 단위 테스트를 줄일 수 있다.
    
1. 아큐먼트
- 함수 정의할 때 타입 시스템 활용해 아규먼트에 제한 거는 코드
    
    ex) 숫자 받아서 팩토리얼 계산하는 코드 → 숫자는 양의 정수여야 함
    
    레이싱카에서 경주 횟수를 입력받는 코드 → 횟수는 양의 정수여야 함
    
- 이러한 제한은 `require` 사용한다.
    - 제한에 대해 만족하지 못할 경우 예외 throw
2. 상태
- 구체적인 조건을 만족할 때만 사용할 수 있게 해야 할 때
    
    ex) 사용자가 로그인했을 때만 처리하게 하고 싶은 함수
    
    ```kotlin
    fun getUserInfo(): UserInfo {
    	checkNotNull(token)
    	...
    }
    ```
    
- `check` 는 require과 비슷하지만, 지정된 예측을 만족하지 못할 때 → `IllegalStateException` 을 throw 함.
- 사용하면 안 되는 곳에서 함수 호출하고 있다고 의심될 때 사용함.
3. Assert 게열 함수 사용
- 구현된 코드에서 참/거짓을 판별하기 좋은 테스트 코드
    
    ```kotlin
    class StackTest {
    	
    	@Test
    	fun `스택 테스트`() {
    		val stack = Stack(20) { it }
    		val ret = stack.pop(10)
    		assertEqueals(10, ret.size)
    	}
    }
    ```
    
- 단위 테스트는 구현의 정확성을 확인하는 가장 좋은 방법 중 하나임.
- 장점
    - Assert 계열은 코드를 자체 점검하며, 더 효율적으로 테스트 가능
    - 특정 상황이 아닌 모든 상황에 대한 테스트 가능
    - 실행 시점에 정확하게 어떻게 되는지 확인 가능
4. nullability와 스마트 캐스팅
- require 와 check 로 조건 확인해서 true 가 나왔다면, 이후로도 true 일 것이라고 가정함.
- `requireNotNull` , `checkNotNull` 함수 사용 가능

```kotlin
fun sendEmail(person: Person, text: String) {
	val email: String = person.email ?: return
}
```

→ 오류 발생시키지 않고, 단순하게 함수 중지하기

```kotlin
fun sendEmail(person: Person, text: String) {
	val email: String = person.email ?: run {
		log("이메일 주소가 없음")
		return
	}
}
```

5. 정리
- 앱 안정적으로 지키기
- 코드 잘못 쓰는 상황 막기
